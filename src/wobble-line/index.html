<!DOCTYPE html>
<html lang="it">
    <head>
        <title>Wobbling line CANVAS</title>
        <meta chrset="utf-8">
        <script src="./wobbling-line.js" type="module"></script>
        <link rel="stylesheet" type="text/css" href="index.css">
    </head>
    <body>
        <wobbling-line width="838px" height="200px" onPhase="onPhase" tick="15">
            <wobbling-segment p="0.5" l="0.8" a="1.0" f="1"></wobbling-segment>
            <wobbling-segment p="0.5" l="0.8" a="0.8" f="1" d="40"></wobbling-segment>
            <wobbling-segment p="0.5" l="0.8" a="0.5" f="1" d="80"></wobbling-segment>
            <wobbling-segment p="0.5" l="0.8" a="0.3" f="1" d="120"></wobbling-segment>
        </wobbling-line>

        <script>
            function onPhase(segment, prev_angle, cur_angle)
            {
                if( prev_angle > cur_angle )
                    prev_angle -= 360;
                const check_angle = 0;
                if( prev_angle < check_angle && cur_angle >= check_angle )
                {
                    segment.a = Math.floor(Math.random() * 10) / 10;
                }
                const delta = cur_angle - prev_angle;
                if( delta > 15 )
                    console.debug(delta);
            }
        </script>
    </body>
</html>